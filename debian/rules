#!/usr/bin/make -f

export DH_VIRTUALENV_VENV_ARGS=--system-site-packages
export PIP_DISABLE_PIP_VERSION_CHECK=1

%:
	dh $@ --with python3,virtualenv --buildsystem=pybuild


override_dh_virtualenv:
	# Install the project into a private virtualenv with pip (prefer wheels)
	dh_virtualenv --python /usr/bin/python3 --extra-pip-args="--prefer-binary"

override_dh_auto_install:
	dh_auto_install
	# Install icons
	install -d debian/wispr-lite/usr/share/icons/hicolor/scalable/apps
	install -m 644 wispr_lite/ui/icons/*.svg debian/wispr-lite/usr/share/icons/hicolor/scalable/apps/
	# Create base app icon alias for .desktop file
	cp debian/wispr-lite/usr/share/icons/hicolor/scalable/apps/wispr-lite-idle.svg \
	   debian/wispr-lite/usr/share/icons/hicolor/scalable/apps/wispr-lite.svg

override_dh_auto_test:
	# Skip tests during package build (run separately with 'make test')

override_dh_installdocs:
	dh_installdocs README.md docs/CONFIG.md
